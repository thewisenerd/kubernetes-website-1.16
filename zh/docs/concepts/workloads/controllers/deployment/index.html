<!DOCTYPE html>
<html id="docs" lang="zh" class="">
	<head>
	

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36037335-10"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-36037335-10');
</script>
<meta charset="utf-8">
<title>Deployments - Kubernetes</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" type="image/png" href="/images/favicon.png">









<link rel="stylesheet" href="/css/style.03896868dcf2dd803b1af07e10dc058b63ac620a0915c37b5add3dd59431555f.css" integrity="sha256-A4loaNzy3YA7GvB&#43;ENwFi2OsYgoJFcN7Wt091ZQxVV8=">


<link rel="stylesheet" href="/css/base_fonts.css">
<link rel="stylesheet" href="/css/jquery-ui.min.css">
<link rel="stylesheet" href="/css/callouts.css">
<link rel="stylesheet" href="/css/custom-jekyll/tags.css">



<meta name="description" content="">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:url" content="https://kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/">
<meta property="og:title" content="Deployments">
<meta name="twitter:title" content="Deployments">
<meta name="twitter:image" content="https://kubernetes.io/images/favicon.png" />

<meta name="twitter:image:alt" content="Kubernetes">

<meta property="og:image" content="/images/kubernetes-horizontal-color.png">

<meta property="og:type" content="article">
<script src="/js/anchor-4.1.1.min.js"></script>
<script src="/js/jquery-3.2.1.min.js"></script>
<script src="/js/jquery-ui-1.12.1.min.js"></script>
<script src="/js/bootstrap-4.3.1.min.js"></script>
<script src="/js/sweetalert-2.1.2.min.js"></script>

<script src="/js/script.js"></script>
<script src="/js/custom-jekyll/tags.js"></script>


	</head>
	<body>
		<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/zh/" class="logo" title="Production-Grade Container Orchestration - Kubernetes" aria-label="Kubernetes website"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            
            
            <li><a href="/zh/docs/" class="active">文档</a></li>
            
            <li><a href="/zh/blog/">博客</a></li>
            
            <li><a href="/zh/partners/">合作伙伴</a></li>
            
            <li><a href="/zh/community/">社区</a></li>
            
            <li><a href="/zh/case-studies/">案例分析</a></li>
            
            
            
             <li>
                <a href="#">
                    中文 Chinese <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="/docs/concepts/workloads/controllers/deployment/">English</a></li>
                
                    <li><a href="/ko/docs/concepts/workloads/controllers/deployment/">한국어 Korean</a></li>
                
                </ul>
            </li>

            <li>
                <a href="#">
                    v1.16 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="https://kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/">v1.20</a></li>
                
                    <li><a href="https://v1-19.docs.kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/">v1.19</a></li>
                
                    <li><a href="https://v1-18.docs.kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/">v1.18</a></li>
                
                    <li><a href="https://v1-17.docs.kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/">v1.17</a></li>
                
                    <li><a href="https://v1-16.docs.kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/">v1.16</a></li>
                
                </ul>
            </li>
        </ul>
        
        <a href="/zh/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>学习 Kubernetes 基础知识</a>
        

        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <div class="main-section" data-auto-burger="primary">
         
           <div class="nav-box">
            <h3><a href="/zh/docs/tutorials/hello-minikube/">Get Started</a></h3>
           <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>

            </div>
         
           <div class="nav-box">
            <h3><a href="/zh/docs/home/">文档</a></h3>
           <p>通过演练，示例和参考文档了解如何使用 Kubernetes。你甚至可以<a href="/editdocs/" data-auto-burger-exclude>帮助贡献文档</a>！</p>

            </div>
         
           <div class="nav-box">
            <h3><a href="/zh/blog/">博客</a></h3>
           <p>阅读关于 kubernetes 和容器规范的最新信息,以及获取最新的技术。</p>

            </div>
         
        </div>
        <div class="main-section" data-auto-burger="primary">
            <div class="left">
                <h5 class="github-invite">想要修改 Kubernetes 的核心源代码？</h5>
                <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>在 GitHub 上查看</a>
            </div>

            <div class="right">
                <h5 class="github-invite">了解社区</h5>
                <div class="social">
                    <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                    <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                    <a href="http://slack.k8s.io/" class="slack"><span>Slack Slack</span></a>
                    <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                    <a href="https://www.youtube.com/kubernetescommunity" class="youtube"><span>YouTube</span></a>
                    <a href="https://discuss.kubernetes.io" class="mailing-list"><span>论坛</span></a>
                    <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>事件日历</span></a>
                </div>
            </div>
            <div class="clear" style="clear: both"></div>
        </div>
    </nav>
</header>

		
		
		<section id="hero" class="light-text no-sub">
			









<h1>概念</h1>
<h5></h5>










<div id="vendorStrip" class="light-text">
	<ul>
		
		
		<li><a href="/zh/docs/home/">主页</a></li>
		
		
		<li><a href="/zh/docs/setup/">入门</a></li>
		
		
		<li><a href="/zh/docs/concepts/" class="YAH">概念</a></li>
		
		
		<li><a href="/zh/docs/tasks/">任务</a></li>
		
		
		<li><a href="/zh/docs/tutorials/">教程</a></li>
		
		
		<li><a href="/zh/docs/reference/">参考</a></li>
		
		
		<li><a href="/zh/docs/contribute/">贡献</a></li>
		
	</ul>
	<form id="searchBox" action="/docs/search/" role="search">
		<input type="text" id="search" name="q" placeholder="搜索" aria-label="Search">
	</form>
</div>

		</section>
		
    
		
<section id="deprecationWarning">
  <main>
    <div class="content deprecation-warning">
      <h3>
	 Kubernetes v1.16
	  版本的文档已不再维护。您现在看到的版本来自于一份静态的快照。如需查阅最新文档，请点击
	 <a href="https://kubernetes.io/docs/home/">最新版本。</a>
      </h3>
    </div>
  </main>
</section>


    <main>
        <section id="encyclopedia">
          
<div id="docsToc">
     <div class="pi-accordion">
    	
        
        
        
        
        
         
             
                 
             
         
             
                 
             
         
             
                 
                          
                          
                 
             
         
             
         
             
         
             
         
             
         
         
        
        <a class="item" data-title="概念" href="/zh/docs/concepts/"></a>

	
	
			
			
			
			
			
		
	
	
	
		
			
<div class="item" data-title="概述">
	<div class="container">
		
		
		
		<a class="item" data-title="概述" href="/zh/docs/concepts/overview/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Kubernetes 是什么？" href="/zh/docs/concepts/overview/what-is-kubernetes/"></a>

		
	
		
			

<a class="item" data-title="Kubernetes 组件" href="/zh/docs/concepts/overview/components/"></a>

		
	
		
			

<a class="item" data-title="Kubernetes API" href="/zh/docs/concepts/overview/kubernetes-api/"></a>

		
	
		
			
<div class="item" data-title="使用 Kubernetes 对象">
	<div class="container">
		
		
		
		<a class="item" data-title="使用 Kubernetes 对象" href="/zh/docs/concepts/overview/working-with-objects/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Kubernetes 对象管理" href="/zh/docs/concepts/overview/working-with-objects/object-management/"></a>

		
	
		
			

<a class="item" data-title="名称" href="/zh/docs/concepts/overview/working-with-objects/names/"></a>

		
	
		
			

<a class="item" data-title="命名空间" href="/zh/docs/concepts/overview/working-with-objects/namespaces/"></a>

		
	
		
			

<a class="item" data-title="标签和选择器" href="/zh/docs/concepts/overview/working-with-objects/labels/"></a>

		
	
		
			

<a class="item" data-title="注解" href="/zh/docs/concepts/overview/working-with-objects/annotations/"></a>

		
	
		
			

<a class="item" data-title="字段选择器" href="/zh/docs/concepts/overview/working-with-objects/field-selectors/"></a>

		
	
		
			

<a class="item" data-title="推荐使用的标签" href="/zh/docs/concepts/overview/working-with-objects/common-labels/"></a>

		
	
		
			

<a class="item" data-title="理解 Kubernetes 对象" href="/zh/docs/concepts/overview/working-with-objects/kubernetes-objects/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Kubernetes 架构">
	<div class="container">
		
		
		
		<a class="item" data-title="Kubernetes 架构" href="/zh/docs/concepts/architecture/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="节点" href="/zh/docs/concepts/architecture/nodes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Controllers <small>(EN)</small>" href="/docs/concepts/architecture/controller/"></a>

		
	
		
			

<a class="item" data-title="云控制器管理器的基础概念" href="/zh/docs/concepts/architecture/cloud-controller/"></a>

		
	
		
			

<a class="item" data-title="Master 节点通信" href="/zh/docs/concepts/architecture/master-node-communication/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="计算、存储和网络扩展">
	<div class="container">
		
		
		
		<a class="item" data-title="计算、存储和网络扩展" href="/zh/docs/concepts/cluster-administration/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="集群管理概述" href="/zh/docs/concepts/cluster-administration/cluster-administration-overview/"></a>

		
	
		
			

<a class="item" data-title="证书" href="/zh/docs/concepts/cluster-administration/certificates/"></a>

		
	
		
			

<a class="item" data-title="云驱动" href="/zh/docs/concepts/cluster-administration/cloud-providers/"></a>

		
	
		
			

<a class="item" data-title="管理资源" href="/zh/docs/concepts/cluster-administration/manage-deployment/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Cluster Networking <small>(EN)</small>" href="/docs/concepts/cluster-administration/networking/"></a>

		
	
		
			

<a class="item" data-title="日志架构" href="/zh/docs/concepts/cluster-administration/logging/"></a>

		
	
		
			

<a class="item" data-title="配置 kubelet 垃圾回收策略" href="/zh/docs/concepts/cluster-administration/kubelet-garbage-collection/"></a>

		
	
		
			

<a class="item" data-title="控制器管理器指标" href="/zh/docs/concepts/cluster-administration/controller-metrics/"></a>

		
	
		
			

<a class="item" data-title="Kubernetes 中的代理" href="/zh/docs/concepts/cluster-administration/proxies/"></a>

		
	
		
			

<a class="item" data-title="安装扩展（Addons）" href="/zh/docs/concepts/cluster-administration/addons/"></a>

		
	
		
			

<a class="item" data-title="联邦" href="/zh/docs/concepts/cluster-administration/federation/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="扩展 Kubernetes">
	<div class="container">
		
		
		
		<a class="item" data-title="扩展 Kubernetes" href="/zh/docs/concepts/extend-kubernetes/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="扩展 Kubernetes 集群" href="/zh/docs/concepts/extend-kubernetes/extend-cluster/"></a>

		
	
		
			
<div class="item" data-title="扩展 Kubernetes API">
	<div class="container">
		
		
		
		<a class="item" data-title="扩展 Kubernetes API" href="/zh/docs/concepts/extend-kubernetes/api-extension/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="通过聚合层扩展 Kubernetes API" href="/zh/docs/concepts/extend-kubernetes/api-extension/apiserver-aggregation/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Custom Resources <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/api-extension/custom-resources/"></a>

		
	

	</div>
</div>

		
	
		
			

<a class="item" target="_blank" data-title="Operator pattern <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/operator/"></a>

		
	
		
			
<div class="item" data-title="计算、存储和网络扩展">
	<div class="container">
		
		
		
		<a class="item" data-title="计算、存储和网络扩展" href="/zh/docs/concepts/extend-kubernetes/compute-storage-net/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="网络插件" href="/zh/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Device Plugins <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/compute-storage-net/device-plugins/"></a>

		
	

	</div>
</div>

		
	
		
			

<a class="item" data-title="服务目录" href="/zh/docs/concepts/extend-kubernetes/service-catalog/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Poseidon-Firmament - An alternate scheduler <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/poseidon-firmament-alternate-scheduler/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="容器">
	<div class="container">
		
		
		
		<a class="item" data-title="容器" href="/zh/docs/concepts/containers/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="镜像" href="/zh/docs/concepts/containers/images/"></a>

		
	
		
			

<a class="item" data-title="容器运行时类(Runtime Class)" href="/zh/docs/concepts/containers/runtime-class/"></a>

		
	
		
			

<a class="item" data-title="容器生命周期钩子" href="/zh/docs/concepts/containers/container-lifecycle-hooks/"></a>

		
	
		
			

<a class="item" data-title="容器环境变量" href="/zh/docs/concepts/containers/container-environment-variables/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="工作负载">
	<div class="container">
		
		
		
		<a class="item" data-title="工作负载" href="/zh/docs/concepts/workloads/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			
<div class="item" data-title="Pods">
	<div class="container">
		
		
		
		<a class="item" data-title="Pods" href="/zh/docs/concepts/workloads/pods/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Pod 概览" href="/zh/docs/concepts/workloads/pods/pod-overview/"></a>

		
	
		
			

<a class="item" data-title="Pods" href="/zh/docs/concepts/workloads/pods/pod/"></a>

		
	
		
			

<a class="item" data-title="Pod Preset" href="/zh/docs/concepts/workloads/pods/podpreset/"></a>

		
	
		
			

<a class="item" data-title="Pod 拓扑扩展约束" href="/zh/docs/concepts/workloads/pods/pod-topology-spread-constraints/"></a>

		
	
		
			

<a class="item" data-title="干扰" href="/zh/docs/concepts/workloads/pods/disruptions/"></a>

		
	
		
			

<a class="item" data-title="临时容器" href="/zh/docs/concepts/workloads/pods/ephemeral-containers/"></a>

		
	
		
			

<a class="item" data-title="Init 容器" href="/zh/docs/concepts/workloads/pods/init-containers/"></a>

		
	
		
			

<a class="item" data-title="Pod 的生命周期" href="/zh/docs/concepts/workloads/pods/pod-lifecycle/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="控制器">
	<div class="container">
		
		
		
		<a class="item" data-title="控制器" href="/zh/docs/concepts/workloads/controllers/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="ReplicaSet" href="/zh/docs/concepts/workloads/controllers/replicaset/"></a>

		
	
		
			

<a class="item" data-title="ReplicationController" href="/zh/docs/concepts/workloads/controllers/replicationcontroller/"></a>

		
	
		
			

<a class="item" data-title="StatefulSets" href="/zh/docs/concepts/workloads/controllers/statefulset/"></a>

		
	
		
			

<a class="item" data-title="DaemonSet" href="/zh/docs/concepts/workloads/controllers/daemonset/"></a>

		
	
		
			

<a class="item" data-title="已完成资源的 TTL 控制器" href="/zh/docs/concepts/workloads/controllers/ttlafterfinished/"></a>

		
	
		
			

<a class="item" data-title="Job 从运行到完成" href="/zh/docs/concepts/workloads/controllers/jobs-run-completion/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Jobs - Run to Completion <small>(EN)</small>" href="/docs/concepts/workloads/controllers/jobs-run-to-completion/"></a>

		
	
		
			

<a class="item" data-title="CronJob" href="/zh/docs/concepts/workloads/controllers/cron-jobs/"></a>

		
	
		
			

<a class="item" data-title="Deployments" href="/zh/docs/concepts/workloads/controllers/deployment/"></a>

		
	
		
			

<a class="item" data-title="垃圾收集" href="/zh/docs/concepts/workloads/controllers/garbage-collection/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="存储">
	<div class="container">
		
		
		
		<a class="item" data-title="存储" href="/zh/docs/concepts/storage/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Volumes" href="/zh/docs/concepts/storage/volumes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Persistent Volumes <small>(EN)</small>" href="/docs/concepts/storage/persistent-volumes/"></a>

		
	
		
			

<a class="item" data-title="卷快照" href="/zh/docs/concepts/storage/volume-snapshots/"></a>

		
	
		
			

<a class="item" data-title="CSI 卷克隆" href="/zh/docs/concepts/storage/volume-pvc-datasource/"></a>

		
	
		
			

<a class="item" data-title="Storage Classes" href="/zh/docs/concepts/storage/storage-classes/"></a>

		
	
		
			

<a class="item" data-title="卷快照类" href="/zh/docs/concepts/storage/volume-snapshot-classes/"></a>

		
	
		
			

<a class="item" data-title="动态卷供应" href="/zh/docs/concepts/storage/dynamic-provisioning/"></a>

		
	
		
			

<a class="item" data-title="特定于节点的卷数限制" href="/zh/docs/concepts/storage/storage-limits/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="配置">
	<div class="container">
		
		
		
		<a class="item" data-title="配置" href="/zh/docs/concepts/configuration/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="扩展资源的资源箱打包" href="/zh/docs/concepts/configuration/resource-bin-packing/"></a>

		
	
		
			

<a class="item" data-title="配置最佳实践" href="/zh/docs/concepts/configuration/overview/"></a>

		
	
		
			

<a class="item" data-title="Pod 开销" href="/zh/docs/concepts/configuration/pod-overhead/"></a>

		
	
		
			

<a class="item" data-title="为容器管理计算资源" href="/zh/docs/concepts/configuration/manage-compute-resources-container/"></a>

		
	
		
			

<a class="item" data-title="将 Pod 分配给节点" href="/zh/docs/concepts/configuration/assign-pod-node/"></a>

		
	
		
			

<a class="item" data-title="Taint 和 Toleration" href="/zh/docs/concepts/configuration/taint-and-toleration/"></a>

		
	
		
			

<a class="item" data-title="Secret" href="/zh/docs/concepts/configuration/secret/"></a>

		
	
		
			

<a class="item" data-title="使用 kubeconfig 文件组织集群访问" href="/zh/docs/concepts/configuration/organize-cluster-access-kubeconfig/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Pod Priority and Preemption <small>(EN)</small>" href="/docs/concepts/configuration/pod-priority-preemption/"></a>

		
	
		
			

<a class="item" data-title="调度框架" href="/zh/docs/concepts/configuration/scheduling-framework/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="服务、负载均衡和联网">
	<div class="container">
		
		
		
		<a class="item" data-title="服务、负载均衡和联网" href="/zh/docs/concepts/services-networking/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Endpoint Slices" href="/zh/docs/concepts/services-networking/endpoint-slices/"></a>

		
	
		
			

<a class="item" data-title="Services" href="/zh/docs/concepts/services-networking/service/"></a>

		
	
		
			

<a class="item" data-title="Pod 与 Service 的 DNS" href="/zh/docs/concepts/services-networking/dns-pod-service/"></a>

		
	
		
			

<a class="item" data-title="应用连接到 Service" href="/zh/docs/concepts/services-networking/connect-applications-service/"></a>

		
	
		
			

<a class="item" data-title="Ingress" href="/zh/docs/concepts/services-networking/ingress/"></a>

		
	
		
			

<a class="item" data-title="Ingress 控制器" href="/zh/docs/concepts/services-networking/ingress-controllers/"></a>

		
	
		
			

<a class="item" data-title="网络策略" href="/zh/docs/concepts/services-networking/network-policies/"></a>

		
	
		
			

<a class="item" data-title="使用 HostAliases 向 Pod /etc/hosts 文件添加条目" href="/zh/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/"></a>

		
	
		
			

<a class="item" data-title="IPv4/IPv6 双协议栈" href="/zh/docs/concepts/services-networking/dual-stack/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="安全">
	<div class="container">
		
		
		
		<a class="item" data-title="安全" href="/zh/docs/concepts/security/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="云原生安全概述" href="/zh/docs/concepts/security/overview/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="调度">
	<div class="container">
		
		
		
		<a class="item" data-title="调度" href="/zh/docs/concepts/scheduling/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Kubernetes 调度器" href="/zh/docs/concepts/scheduling/kube-scheduler/"></a>

		
	
		
			

<a class="item" data-title="调度器性能调优" href="/zh/docs/concepts/scheduling/scheduler-perf-tuning/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="策略">
	<div class="container">
		
		
		
		<a class="item" data-title="策略" href="/zh/docs/concepts/policy/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Limit Ranges <small>(EN)</small>" href="/docs/concepts/policy/limit-range/"></a>

		
	
		
			

<a class="item" data-title="Pod 安全策略" href="/zh/docs/concepts/policy/pod-security-policy/"></a>

		
	
		
			

<a class="item" data-title="资源配额" href="/zh/docs/concepts/policy/resource-quotas/"></a>

		
	

	</div>
</div>

		
	
		
			

<a class="item" data-title="概念模板示例" href="/zh/docs/concepts/example-concept-template/"></a>

		
	





     </div> 
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 


          <div id="docsContent">
            

<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/zh/docs/concepts/workloads/controllers/deployment.md" id="editPageButton" target="_blank">
    Edit This Page
  </a>
</p>

<h1>Deployments</h1>



<p>A <em>Deployment</em> controller provides declarative updates for <a href="/docs/concepts/workloads/pods/pod/">Pods</a> and
<a href="/docs/concepts/workloads/controllers/replicaset/">ReplicaSets</a>.</p>

<p>You describe a <em>desired state</em> in a Deployment object, and the Deployment controller changes the actual state to the desired state at a controlled rate. You can define Deployments to create new ReplicaSets, or to remove existing Deployments and adopt all their resources with new Deployments.</p>

<blockquote class="note">
  <div><strong>注意：</strong> You should not manage ReplicaSets owned by a Deployment. All the use cases should be covered by manipulating the Deployment object. Consider opening an issue in the main Kubernetes repository if your use case is not covered below.</div>
</blockquote>









<ul id="markdown-toc">










<li><a href="#use-case">Use Case</a></li>




<li><a href="#creating-a-deployment">Creating a Deployment</a></li>




<li><a href="#updating-a-deployment">Updating a Deployment</a></li>




<li><a href="#rolling-back-a-deployment">Rolling Back a Deployment</a></li>




<li><a href="#scaling-a-deployment">Scaling a Deployment</a></li>




<li><a href="#pausing-and-resuming-a-deployment">Pausing and Resuming a Deployment</a></li>




<li><a href="#deployment-status">Deployment status</a></li>




<li><a href="#clean-up-policy">Clean up Policy</a></li>




<li><a href="#use-cases">Use Cases</a></li>




<li><a href="#writing-a-deployment-spec">Writing a Deployment Spec</a></li>




<li><a href="#alternative-to-deployments">Alternative to Deployments</a></li>



















</ul>


<h2 id="use-case">Use Case</h2>

<p>The following are typical use cases for Deployments:</p>

<ul>
<li><a href="#use-case">Use Case</a></li>
<li><a href="#creating-a-deployment">Creating a Deployment</a>

<ul>
<li><a href="#pod-template-hash-label">Pod-template-hash label</a></li>
</ul></li>
<li><a href="#updating-a-deployment">Updating a Deployment</a>

<ul>
<li><a href="#rollover-aka-multiple-updates-in-flight">Rollover (aka multiple updates in-flight)</a></li>
<li><a href="#label-selector-updates">Label selector updates</a></li>
</ul></li>
<li><a href="#rolling-back-a-deployment">Rolling Back a Deployment</a>

<ul>
<li><a href="#checking-rollout-history-of-a-deployment">Checking Rollout History of a Deployment</a></li>
<li><a href="#rolling-back-to-a-previous-revision">Rolling Back to a Previous Revision</a></li>
</ul></li>
<li><a href="#scaling-a-deployment">Scaling a Deployment</a>

<ul>
<li><a href="#proportional-scaling">Proportional scaling</a></li>
</ul></li>
<li><a href="#pausing-and-resuming-a-deployment">Pausing and Resuming a Deployment</a></li>
<li><a href="#deployment-status">Deployment status</a>

<ul>
<li><a href="#progressing-deployment">Progressing Deployment</a></li>
<li><a href="#complete-deployment">Complete Deployment</a></li>
<li><a href="#failed-deployment">Failed Deployment</a></li>
<li><a href="#operating-on-a-failed-deployment">Operating on a failed deployment</a></li>
</ul></li>
<li><a href="#clean-up-policy">Clean up Policy</a></li>
<li><a href="#use-cases">Use Cases</a>

<ul>
<li><a href="#canary-deployment">Canary Deployment</a></li>
</ul></li>
<li><a href="#writing-a-deployment-spec">Writing a Deployment Spec</a>

<ul>
<li><a href="#pod-template">Pod Template</a></li>
<li><a href="#replicas">Replicas</a></li>
<li><a href="#selector">Selector</a></li>
<li><a href="#strategy">Strategy</a></li>
<li><a href="#recreate-deployment">Recreate Deployment</a></li>
<li><a href="#rolling-update-deployment">Rolling Update Deployment</a>

<ul>
<li><a href="#max-unavailable">Max Unavailable</a></li>
<li><a href="#max-surge">Max Surge</a></li>
</ul></li>
<li><a href="#progress-deadline-seconds">Progress Deadline Seconds</a></li>
<li><a href="#min-ready-seconds">Min Ready Seconds</a></li>
<li><a href="#rollback-to">Rollback To</a></li>
<li><a href="#revision">Revision</a></li>
<li><a href="#revision-history-limit">Revision History Limit</a></li>
<li><a href="#paused">Paused</a></li>
</ul></li>
<li><a href="#alternative-to-deployments">Alternative to Deployments</a>

<ul>
<li><a href="#kubectl-rolling-update">kubectl rolling update</a></li>
</ul></li>
</ul>

<h2 id="creating-a-deployment">Creating a Deployment</h2>

<p>Here is an example Deployment. It creates a ReplicaSet to bring up three nginx Pods.</p>

<table class="includecode" id="controllers-nginx-deployment-yaml">
    <thead>
        <tr>
            <th>
                <a href="https://raw.githubusercontent.com/kubernetes/website/master/content/zh/examples/controllers/nginx-deployment.yaml" download="controllers/nginx-deployment.yaml">
                    <code>controllers/nginx-deployment.yaml</code>
                </a>
                <img src="/images/copycode.svg" style="max-height:24px" onclick="copyCode('controllers-nginx-deployment-yaml')" title="Copy controllers/nginx-deployment.yaml to clipboard">
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>apps/v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Deployment<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>nginx-deployment<span style="color:#bbb">
</span><span style="color:#bbb">  </span>labels:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>app:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>replicas:<span style="color:#bbb"> </span><span style="color:#666">3</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>selector:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>matchLabels:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>app:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span><span style="color:#bbb">  </span>template:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>labels:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>app:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span><span style="color:#bbb">    </span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>nginx<span style="color:#bbb">
</span><span style="color:#bbb">        </span>image:<span style="color:#bbb"> </span>nginx:<span style="color:#666">1.7.9</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span>ports:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>-<span style="color:#bbb"> </span>containerPort:<span style="color:#bbb"> </span><span style="color:#666">80</span><span style="color:#bbb">
</span></code></pre></div>  </td>
        </tr>
    </tbody>
</table>

<p>Run the example by downloading the example file and then running this command:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -f https://k8s.io/examples/controllers/nginx-deployment.yaml</code></pre></div>
<p>Setting the kubectl flag <code>--record</code> to <code>true</code> allows you to record current command in the annotations of
the resources being created or updated. It is useful for future introspection: for example, to see the
commands executed in each Deployment revision.</p>

<p>Then running <code>get</code> immediately will give:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get deployments
NAME               DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx-deployment   <span style="color:#666">3</span>         <span style="color:#666">0</span>         <span style="color:#666">0</span>            <span style="color:#666">0</span>           1s</code></pre></div>
<p>This indicates that the Deployment&rsquo;s number of desired replicas is 3 (according to deployment&rsquo;s <code>.spec.replicas</code>),
the number of current replicas (<code>.status.replicas</code>) is 0, the number of up-to-date replicas (<code>.status.updatedReplicas</code>)
is 0, and the number of available replicas (<code>.status.availableReplicas</code>) is also 0.</p>

<p>To see the Deployment rollout status, run:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout status deployment/nginx-deployment
Waiting <span style="color:#a2f;font-weight:bold">for</span> rollout to finish: <span style="color:#666">2</span> out of <span style="color:#666">3</span> new replicas have been updated...
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> successfully rolled out</code></pre></div>
<p>Running the <code>get</code> again a few seconds later should give:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get deployments
NAME               DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx-deployment   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">3</span>            <span style="color:#666">3</span>           18s</code></pre></div>
<p>This indicates that the Deployment has created all three replicas, and all replicas are up-to-date (contains the
latest pod template) and available (pod status is ready for at least Deployment&rsquo;s <code>.spec.minReadySeconds</code>). Running
<code>kubectl get rs</code> and <code>kubectl get pods</code> will show the ReplicaSet (RS) and Pods created.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get rs
NAME                          DESIRED   CURRENT   READY   AGE
nginx-deployment-2035384211   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">3</span>       18s</code></pre></div>
<p>You may notice that the name of the ReplicaSet is always <code>&lt;the name of the Deployment&gt;-&lt;hash value of the pod template&gt;</code>.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get pods --show-labels
NAME                                READY     STATUS    RESTARTS   AGE       LABELS
nginx-deployment-2035384211-7ci7o   <span style="color:#666">1</span>/1       Running   <span style="color:#666">0</span>          18s       <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx,pod-template-hash<span style="color:#666">=</span><span style="color:#666">2035384211</span>
nginx-deployment-2035384211-kzszj   <span style="color:#666">1</span>/1       Running   <span style="color:#666">0</span>          18s       <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx,pod-template-hash<span style="color:#666">=</span><span style="color:#666">2035384211</span>
nginx-deployment-2035384211-qqcnn   <span style="color:#666">1</span>/1       Running   <span style="color:#666">0</span>          18s       <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx,pod-template-hash<span style="color:#666">=</span><span style="color:#666">2035384211</span></code></pre></div>
<p>The created ReplicaSet ensures that there are three nginx Pods at all times.</p>

<blockquote class="note">
  <div><strong>注意：</strong> You must specify an appropriate selector and pod template labels in a Deployment (in this case,
<code>app = nginx</code>). That is, don&rsquo;t overlap with other controllers (including other Deployments, ReplicaSets,
StatefulSets, etc.). Kubernetes doesn&rsquo;t stop you from overlapping, and if multiple
controllers have overlapping selectors, those controllers may fight with each other and won&rsquo;t behave
correctly.</div>
</blockquote>

<h3 id="pod-template-hash-label">Pod-template-hash label</h3>

<blockquote class="note">
  <div><strong>注意：</strong> Do not change this label.</div>
</blockquote>

<p>Note the pod-template-hash label in the example output in the pod labels above. This label is added by the
Deployment controller to every ReplicaSet that a Deployment creates or adopts. Its purpose is to make sure that child
ReplicaSets of a Deployment do not overlap. It is computed by hashing the PodTemplate of the ReplicaSet
and using the resulting hash as the label value that will be added in the ReplicaSet selector, pod template labels,
and in any existing Pods that the ReplicaSet may have.</p>

<h2 id="updating-a-deployment">Updating a Deployment</h2>

<blockquote class="note">
  <div><strong>注意：</strong> A Deployment&rsquo;s rollout is triggered if and only if the Deployment&rsquo;s pod template (that is, <code>.spec.template</code>)
is changed, for example if the labels or container images of the template are updated. Other updates, such as scaling the Deployment, do not trigger a rollout.</div>
</blockquote>

<p>Suppose that we now want to update the nginx Pods to use the <code>nginx:1.9.1</code> image
instead of the <code>nginx:1.7.9</code> image.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl <span style="color:#a2f">set</span> image deployment/nginx-deployment <span style="color:#b8860b">nginx</span><span style="color:#666">=</span>nginx:1.9.1
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> image updated</code></pre></div>
<p>Alternatively, we can <code>edit</code> the Deployment and change <code>.spec.template.spec.containers[0].image</code> from <code>nginx:1.7.9</code> to <code>nginx:1.9.1</code>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl edit deployment/nginx-deployment
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> edited</code></pre></div>
<p>To see the rollout status, run:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout status deployment/nginx-deployment
Waiting <span style="color:#a2f;font-weight:bold">for</span> rollout to finish: <span style="color:#666">2</span> out of <span style="color:#666">3</span> new replicas have been updated...
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> successfully rolled out</code></pre></div>
<p>After the rollout succeeds, you may want to <code>get</code> the Deployment:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get deployments
NAME               DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx-deployment   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">3</span>            <span style="color:#666">3</span>           36s</code></pre></div>
<p>The number of up-to-date replicas indicates that the Deployment has updated the replicas to the latest configuration.
The current replicas indicates the total replicas this Deployment manages, and the available replicas indicates the
number of current replicas that are available.</p>

<p>We can run <code>kubectl get rs</code> to see that the Deployment updated the Pods by creating a new ReplicaSet and scaling it
up to 3 replicas, as well as scaling down the old ReplicaSet to 0 replicas.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get rs
NAME                          DESIRED   CURRENT   READY   AGE
nginx-deployment-1564180365   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">3</span>       6s
nginx-deployment-2035384211   <span style="color:#666">0</span>         <span style="color:#666">0</span>         <span style="color:#666">0</span>       36s</code></pre></div>
<p>Running <code>get pods</code> should now show only the new Pods:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get pods
NAME                                READY     STATUS    RESTARTS   AGE
nginx-deployment-1564180365-khku8   <span style="color:#666">1</span>/1       Running   <span style="color:#666">0</span>          14s
nginx-deployment-1564180365-nacti   <span style="color:#666">1</span>/1       Running   <span style="color:#666">0</span>          14s
nginx-deployment-1564180365-z9gth   <span style="color:#666">1</span>/1       Running   <span style="color:#666">0</span>          14s</code></pre></div>
<p>Next time we want to update these Pods, we only need to update the Deployment&rsquo;s pod template again.</p>

<p>Deployment can ensure that only a certain number of Pods may be down while they are being updated. By
default, it ensures that at least 1 less than the desired number of Pods are up (1 max unavailable).</p>

<p>Deployment can also ensure that only a certain number of Pods may be created above the desired number of
Pods. By default, it ensures that at most 1 more than the desired number of Pods are up (1 max surge).</p>

<p>In a future version of Kubernetes, the defaults will change from 1-1 to 25%-25%.</p>

<p>For example, if you look at the above Deployment closely, you will see that it first created a new Pod,
then deleted some old Pods and created new ones. It does not kill old Pods until a sufficient number of
new Pods have come up, and does not create new Pods until a sufficient number of old Pods have been killed.
It makes sure that the number of available Pods is at least 2 and the number of total Pods is at most 4.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl describe deployments
Name:           nginx-deployment
Namespace:      default
CreationTimestamp:  Tue, <span style="color:#666">15</span> Mar <span style="color:#666">2016</span> <span style="color:#666">12</span>:01:06 -0700
Labels:         <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx
Selector:       <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx
Replicas:       <span style="color:#666">3</span> updated | <span style="color:#666">3</span> total | <span style="color:#666">3</span> available | <span style="color:#666">0</span> unavailable
StrategyType:       RollingUpdate
MinReadySeconds:    <span style="color:#666">0</span>
RollingUpdateStrategy:  <span style="color:#666">1</span> max unavailable, <span style="color:#666">1</span> max surge
OldReplicaSets:     &lt;none&gt;
NewReplicaSet:      nginx-deployment-1564180365 <span style="color:#666">(</span><span style="color:#666">3</span>/3 replicas created<span style="color:#666">)</span>
Events:
  FirstSeen LastSeen    Count   From                     SubobjectPath   Type        Reason              Message
  --------- --------    -----   ----                     -------------   --------    ------              -------
  36s       36s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                 Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-2035384211 to <span style="color:#666">3</span>
  23s       23s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                 Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">1</span>
  23s       23s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                 Normal      ScalingReplicaSet   Scaled down replica <span style="color:#a2f">set</span> nginx-deployment-2035384211 to <span style="color:#666">2</span>
  23s       23s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                 Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">2</span>
  21s       21s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                 Normal      ScalingReplicaSet   Scaled down replica <span style="color:#a2f">set</span> nginx-deployment-2035384211 to <span style="color:#666">0</span>
  21s       21s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                 Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">3</span></code></pre></div>
<p>Here we see that when we first created the Deployment, it created a ReplicaSet (nginx-deployment-2035384211)
and scaled it up to 3 replicas directly. When we updated the Deployment, it created a new ReplicaSet
(nginx-deployment-1564180365) and scaled it up to 1 and then scaled down the old ReplicaSet to 2, so that at
least 2 Pods were available and at most 4 Pods were created at all times. It then continued scaling up and down
the new and the old ReplicaSet, with the same rolling update strategy. Finally, we&rsquo;ll have 3 available replicas
in the new ReplicaSet, and the old ReplicaSet is scaled down to 0.</p>

<h3 id="rollover-aka-multiple-updates-in-flight">Rollover (aka multiple updates in-flight)</h3>

<p>Each time a new deployment object is observed by the deployment controller, a ReplicaSet is created to bring up
the desired Pods if there is no existing ReplicaSet doing so. Existing ReplicaSet controlling Pods whose labels
match <code>.spec.selector</code> but whose template does not match <code>.spec.template</code> are scaled down. Eventually, the new
ReplicaSet will be scaled to <code>.spec.replicas</code> and all old ReplicaSets will be scaled to 0.</p>

<p>If you update a Deployment while an existing rollout is in progress, the Deployment will create a new ReplicaSet
as per the update and start scaling that up, and will roll over the ReplicaSet that it was scaling up previously
 &ndash; it will add it to its list of old ReplicaSets and will start scaling it down.</p>

<p>For example, suppose you create a Deployment to create 5 replicas of <code>nginx:1.7.9</code>,
but then updates the Deployment to create 5 replicas of <code>nginx:1.9.1</code>, when only 3
replicas of <code>nginx:1.7.9</code> had been created. In that case, Deployment will immediately start
killing the 3 <code>nginx:1.7.9</code> Pods that it had created, and will start creating
<code>nginx:1.9.1</code> Pods. It will not wait for 5 replicas of <code>nginx:1.7.9</code> to be created
before changing course.</p>

<h3 id="label-selector-updates">Label selector updates</h3>

<p>It is generally discouraged to make label selector updates and it is suggested to plan your selectors up front.
In any case, if you need to perform a label selector update, exercise great caution and make sure you have grasped
all of the implications.</p>

<ul>
<li>Selector additions require the pod template labels in the Deployment spec to be updated with the new label too,
otherwise a validation error is returned. This change is a non-overlapping one, meaning that the new selector does
not select ReplicaSets and Pods created with the old selector, resulting in orphaning all old ReplicaSets and
creating a new ReplicaSet.</li>
<li>Selector updates &ndash; that is, changing the existing value in a selector key &ndash; result in the same behavior as additions.</li>
<li>Selector removals &ndash; that is, removing an existing key from the Deployment selector &ndash; do not require any changes in the
pod template labels. No existing ReplicaSet is orphaned, and a new ReplicaSet is not created, but note that the
removed label still exists in any existing Pods and ReplicaSets.</li>
</ul>

<h2 id="rolling-back-a-deployment">Rolling Back a Deployment</h2>

<p>Sometimes you may want to rollback a Deployment; for example, when the Deployment is not stable, such as crash looping.
By default, all of the Deployment&rsquo;s rollout history is kept in the system so that you can rollback anytime you want
(you can change that by modifying revision history limit).</p>

<blockquote class="note">
  <div><strong>注意：</strong> A Deployment&rsquo;s revision is created when a Deployment&rsquo;s rollout is triggered. This means that the
new revision is created if and only if the Deployment&rsquo;s pod template (<code>.spec.template</code>) is changed,
for example if you update the labels or container images of the template. Other updates, such as scaling the Deployment,
do not create a Deployment revision, so that we can facilitate simultaneous manual- or auto-scaling.
This means that when you roll back to an earlier revision, only the Deployment&rsquo;s pod template part is
rolled back.</div>
</blockquote>

<p>Suppose that we made a typo while updating the Deployment, by putting the image name as <code>nginx:1.91</code> instead of <code>nginx:1.9.1</code>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl <span style="color:#a2f">set</span> image deployment/nginx-deployment <span style="color:#b8860b">nginx</span><span style="color:#666">=</span>nginx:1.91
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> image updated</code></pre></div>
<p>The rollout will be stuck.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout status deployments nginx-deployment
Waiting <span style="color:#a2f;font-weight:bold">for</span> rollout to finish: <span style="color:#666">2</span> out of <span style="color:#666">3</span> new replicas have been updated...</code></pre></div>
<p>Press Ctrl-C to stop the above rollout status watch. For more information on stuck rollouts,
<a href="#deployment-status">read more here</a>.</p>

<p>You will also see that both the number of old replicas (nginx-deployment-1564180365 and
nginx-deployment-2035384211) and new replicas (nginx-deployment-3066724191) are 2.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get rs
NAME                          DESIRED   CURRENT   READY   AGE
nginx-deployment-1564180365   <span style="color:#666">2</span>         <span style="color:#666">2</span>         <span style="color:#666">0</span>       25s
nginx-deployment-2035384211   <span style="color:#666">0</span>         <span style="color:#666">0</span>         <span style="color:#666">0</span>       36s
nginx-deployment-3066724191   <span style="color:#666">2</span>         <span style="color:#666">2</span>         <span style="color:#666">2</span>       6s</code></pre></div>
<p>Looking at the Pods created, you will see that the 2 Pods created by new ReplicaSet are stuck in an image pull loop.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get pods
NAME                                READY     STATUS             RESTARTS   AGE
nginx-deployment-1564180365-70iae   <span style="color:#666">1</span>/1       Running            <span style="color:#666">0</span>          25s
nginx-deployment-1564180365-jbqqo   <span style="color:#666">1</span>/1       Running            <span style="color:#666">0</span>          25s
nginx-deployment-3066724191-08mng   <span style="color:#666">0</span>/1       ImagePullBackOff   <span style="color:#666">0</span>          6s
nginx-deployment-3066724191-eocby   <span style="color:#666">0</span>/1       ImagePullBackOff   <span style="color:#666">0</span>          6s</code></pre></div>
<blockquote class="note">
  <div><strong>注意：</strong> The Deployment controller will stop the bad rollout automatically, and will stop scaling up the new
ReplicaSet. This depends on the rollingUpdate parameters (<code>maxUnavailable</code> specifically) that you have specified.
Kubernetes by default sets the value to 1 and spec.replicas to 1 so if you haven&rsquo;t cared about setting those
parameters, your Deployment can have 100% unavailability by default! This will be fixed in Kubernetes in a future
version.</div>
</blockquote>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl describe deployment
Name:           nginx-deployment
Namespace:      default
CreationTimestamp:  Tue, <span style="color:#666">15</span> Mar <span style="color:#666">2016</span> <span style="color:#666">14</span>:48:04 -0700
Labels:         <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx
Selector:       <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx
Replicas:       <span style="color:#666">2</span> updated | <span style="color:#666">3</span> total | <span style="color:#666">2</span> available | <span style="color:#666">2</span> unavailable
StrategyType:       RollingUpdate
MinReadySeconds:    <span style="color:#666">0</span>
RollingUpdateStrategy:  <span style="color:#666">1</span> max unavailable, <span style="color:#666">1</span> max surge
OldReplicaSets:     nginx-deployment-1564180365 <span style="color:#666">(</span><span style="color:#666">2</span>/2 replicas created<span style="color:#666">)</span>
NewReplicaSet:      nginx-deployment-3066724191 <span style="color:#666">(</span><span style="color:#666">2</span>/2 replicas created<span style="color:#666">)</span>
Events:
  FirstSeen LastSeen    Count   From                    SubobjectPath   Type        Reason              Message
  --------- --------    -----   ----                    -------------   --------    ------              -------
  1m        1m          <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-2035384211 to <span style="color:#666">3</span>
  22s       22s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">1</span>
  22s       22s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled down replica <span style="color:#a2f">set</span> nginx-deployment-2035384211 to <span style="color:#666">2</span>
  22s       22s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">2</span>
  21s       21s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled down replica <span style="color:#a2f">set</span> nginx-deployment-2035384211 to <span style="color:#666">0</span>
  21s       21s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">3</span>
  13s       13s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-3066724191 to <span style="color:#666">1</span>
  13s       13s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled down replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">2</span>
  13s       13s         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-3066724191 to <span style="color:#666">2</span></code></pre></div>
<p>To fix this, we need to rollback to a previous revision of Deployment that is stable.</p>

<h3 id="checking-rollout-history-of-a-deployment">Checking Rollout History of a Deployment</h3>

<p>First, check the revisions of this deployment:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout <span style="color:#a2f">history</span> deployment/nginx-deployment
deployments <span style="color:#b44">&#34;nginx-deployment&#34;</span>
REVISION    CHANGE-CAUSE
<span style="color:#666">1</span>           kubectl apply -f https://k8s.io/examples/controllers/nginx-deployment.yaml
<span style="color:#666">2</span>           kubectl <span style="color:#a2f">set</span> image deployment/nginx-deployment <span style="color:#b8860b">nginx</span><span style="color:#666">=</span>nginx:1.9.1
<span style="color:#666">3</span>           kubectl <span style="color:#a2f">set</span> image deployment/nginx-deployment <span style="color:#b8860b">nginx</span><span style="color:#666">=</span>nginx:1.91</code></pre></div>
<p>Because we recorded the command while creating this Deployment using <code>--record</code>, we can easily see
the changes we made in each revision.</p>

<p>To further see the details of each revision, run:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout <span style="color:#a2f">history</span> deployment/nginx-deployment --revision<span style="color:#666">=</span><span style="color:#666">2</span>
deployments <span style="color:#b44">&#34;nginx-deployment&#34;</span> revision <span style="color:#666">2</span>
  Labels:       <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx
          pod-template-hash<span style="color:#666">=</span><span style="color:#666">1159050644</span>
  Annotations:  kubernetes.io/change-cause<span style="color:#666">=</span>kubectl <span style="color:#a2f">set</span> image deployment/nginx-deployment <span style="color:#b8860b">nginx</span><span style="color:#666">=</span>nginx:1.9.1
  Containers:
   nginx:
    Image:      nginx:1.9.1
    Port:       <span style="color:#666">80</span>/TCP
     QoS Tier:
        cpu:      BestEffort
        memory:   BestEffort
    Environment Variables:      &lt;none&gt;
  No volumes.</code></pre></div>
<h3 id="rolling-back-to-a-previous-revision">Rolling Back to a Previous Revision</h3>

<p>Now we&rsquo;ve decided to undo the current rollout and rollback to the previous revision:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout undo deployment/nginx-deployment
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> rolled back</code></pre></div>
<p>Alternatively, you can rollback to a specific revision by specifying it with <code>--to-revision</code>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout undo deployment/nginx-deployment --to-revision<span style="color:#666">=</span><span style="color:#666">2</span>
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> rolled back</code></pre></div>
<p>For more details about rollout related commands, read <a href="/docs/user-guide/kubectl/v1.16/#rollout"><code>kubectl rollout</code></a>.</p>

<p>The Deployment is now rolled back to a previous stable revision. As you can see, a <code>DeploymentRollback</code> event
for rolling back to revision 2 is generated from Deployment controller.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get deployment
NAME               DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx-deployment   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">3</span>            <span style="color:#666">3</span>           30m

$ kubectl describe deployment
Name:           nginx-deployment
Namespace:      default
CreationTimestamp:  Tue, <span style="color:#666">15</span> Mar <span style="color:#666">2016</span> <span style="color:#666">14</span>:48:04 -0700
Labels:         <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx
Selector:       <span style="color:#b8860b">app</span><span style="color:#666">=</span>nginx
Replicas:       <span style="color:#666">3</span> updated | <span style="color:#666">3</span> total | <span style="color:#666">3</span> available | <span style="color:#666">0</span> unavailable
StrategyType:       RollingUpdate
MinReadySeconds:    <span style="color:#666">0</span>
RollingUpdateStrategy:  <span style="color:#666">1</span> max unavailable, <span style="color:#666">1</span> max surge
OldReplicaSets:     &lt;none&gt;
NewReplicaSet:      nginx-deployment-1564180365 <span style="color:#666">(</span><span style="color:#666">3</span>/3 replicas created<span style="color:#666">)</span>
Events:
  FirstSeen LastSeen    Count   From                    SubobjectPath   Type        Reason              Message
  --------- --------    -----   ----                    -------------   --------    ------              -------
  30m       30m         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-2035384211 to <span style="color:#666">3</span>
  29m       29m         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">1</span>
  29m       29m         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled down replica <span style="color:#a2f">set</span> nginx-deployment-2035384211 to <span style="color:#666">2</span>
  29m       29m         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">2</span>
  29m       29m         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled down replica <span style="color:#a2f">set</span> nginx-deployment-2035384211 to <span style="color:#666">0</span>
  29m       29m         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-3066724191 to <span style="color:#666">2</span>
  29m       29m         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-3066724191 to <span style="color:#666">1</span>
  29m       29m         <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled down replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">2</span>
  2m        2m          <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled down replica <span style="color:#a2f">set</span> nginx-deployment-3066724191 to <span style="color:#666">0</span>
  2m        2m          <span style="color:#666">1</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      DeploymentRollback  Rolled back deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> to revision <span style="color:#666">2</span>
  29m       2m          <span style="color:#666">2</span>       <span style="color:#666">{</span>deployment-controller <span style="color:#666">}</span>                Normal      ScalingReplicaSet   Scaled up replica <span style="color:#a2f">set</span> nginx-deployment-1564180365 to <span style="color:#666">3</span></code></pre></div>
<h2 id="scaling-a-deployment">Scaling a Deployment</h2>

<p>You can scale a Deployment by using the following command:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl scale deployment nginx-deployment --replicas<span style="color:#666">=</span><span style="color:#666">10</span>
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> scaled</code></pre></div>
<p>Assuming <a href="/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/">horizontal pod autoscaling</a> is enabled
in your cluster, you can setup an autoscaler for your Deployment and choose the minimum and maximum number of
Pods you want to run based on the CPU utilization of your existing Pods.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl autoscale deployment nginx-deployment --min<span style="color:#666">=</span><span style="color:#666">10</span> --max<span style="color:#666">=</span><span style="color:#666">15</span> --cpu-percent<span style="color:#666">=</span><span style="color:#666">80</span>
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> autoscaled</code></pre></div>
<h3 id="proportional-scaling">Proportional scaling</h3>

<p>RollingUpdate Deployments support running multiple versions of an application at the same time. When you
or an autoscaler scales a RollingUpdate Deployment that is in the middle of a rollout (either in progress
or paused), then the Deployment controller will balance the additional replicas in the existing active
ReplicaSets (ReplicaSets with Pods) in order to mitigate risk. This is called <em>proportional scaling</em>.</p>

<p>For example, you are running a Deployment with 10 replicas, <a href="#max-surge">maxSurge</a>=3, and <a href="#max-unavailable">maxUnavailable</a>=2.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get deploy
NAME                 DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx-deployment     <span style="color:#666">10</span>        <span style="color:#666">10</span>        <span style="color:#666">10</span>           <span style="color:#666">10</span>          50s</code></pre></div>
<p>You update to a new image which happens to be unresolvable from inside the cluster.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl <span style="color:#a2f">set</span> image deploy/nginx-deployment <span style="color:#b8860b">nginx</span><span style="color:#666">=</span>nginx:sometag
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> image updated</code></pre></div>
<p>The image update starts a new rollout with ReplicaSet nginx-deployment-1989198191, but it&rsquo;s blocked due to the
maxUnavailable requirement that we mentioned above.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get rs
NAME                          DESIRED   CURRENT   READY     AGE
nginx-deployment-1989198191   <span style="color:#666">5</span>         <span style="color:#666">5</span>         <span style="color:#666">0</span>         9s
nginx-deployment-618515232    <span style="color:#666">8</span>         <span style="color:#666">8</span>         <span style="color:#666">8</span>         1m</code></pre></div>
<p>Then a new scaling request for the Deployment comes along. The autoscaler increments the Deployment replicas
to 15. The Deployment controller needs to decide where to add these new 5 replicas. If we weren&rsquo;t using
proportional scaling, all 5 of them would be added in the new ReplicaSet. With proportional scaling, we
spread the additional replicas across all ReplicaSets. Bigger proportions go to the ReplicaSets with the
most replicas and lower proportions go to ReplicaSets with less replicas. Any leftovers are added to the
ReplicaSet with the most replicas. ReplicaSets with zero replicas are not scaled up.</p>

<p>In our example above, 3 replicas will be added to the old ReplicaSet and 2 replicas will be added to the
new ReplicaSet. The rollout process should eventually move all replicas to the new ReplicaSet, assuming
the new replicas become healthy.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get deploy
NAME                 DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx-deployment     <span style="color:#666">15</span>        <span style="color:#666">18</span>        <span style="color:#666">7</span>            <span style="color:#666">8</span>           7m
$ kubectl get rs
NAME                          DESIRED   CURRENT   READY     AGE
nginx-deployment-1989198191   <span style="color:#666">7</span>         <span style="color:#666">7</span>         <span style="color:#666">0</span>         7m
nginx-deployment-618515232    <span style="color:#666">11</span>        <span style="color:#666">11</span>        <span style="color:#666">11</span>        7m</code></pre></div>
<h2 id="pausing-and-resuming-a-deployment">Pausing and Resuming a Deployment</h2>

<p>You can pause a Deployment before triggering one or more updates and then resume it. This will allow you to
apply multiple fixes in between pausing and resuming without triggering unnecessary rollouts.</p>

<p>For example, with a Deployment that was just created:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get deploy
NAME      DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx     <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">3</span>            <span style="color:#666">3</span>           1m
$ kubectl get rs
NAME               DESIRED   CURRENT   READY     AGE
nginx-2142116321   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">3</span>         1m</code></pre></div>
<p>Pause by running the following command:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout pause deployment/nginx-deployment
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> paused</code></pre></div>
<p>Then update the image of the Deployment:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl <span style="color:#a2f">set</span> image deploy/nginx-deployment <span style="color:#b8860b">nginx</span><span style="color:#666">=</span>nginx:1.9.1
deployment <span style="color:#b44">&#34;nginx-deployment&#34;</span> image updated</code></pre></div>
<p>Notice that no new rollout started:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout <span style="color:#a2f">history</span> deploy/nginx-deployment
deployments <span style="color:#b44">&#34;nginx&#34;</span>
REVISION  CHANGE-CAUSE
<span style="color:#666">1</span>   &lt;none&gt;

$ kubectl get rs
NAME               DESIRED   CURRENT   READY     AGE
nginx-2142116321   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">3</span>         2m</code></pre></div>
<p>You can make as many updates as you wish, for example, update the resources that will be used:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl <span style="color:#a2f">set</span> resources deployment nginx -c<span style="color:#666">=</span>nginx --limits<span style="color:#666">=</span><span style="color:#b8860b">cpu</span><span style="color:#666">=</span>200m,memory<span style="color:#666">=</span>512Mi
deployment <span style="color:#b44">&#34;nginx&#34;</span> resource requirements updated</code></pre></div>
<p>The initial state of the Deployment prior to pausing it will continue its function, but new updates to
the Deployment will not have any effect as long as the Deployment is paused.</p>

<p>Eventually, resume the Deployment and observe a new ReplicaSet coming up with all the new updates:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout resume deploy/nginx-deployment
deployment <span style="color:#b44">&#34;nginx&#34;</span> resumed
$ kubectl get rs -w
NAME               DESIRED   CURRENT   READY     AGE
nginx-2142116321   <span style="color:#666">2</span>         <span style="color:#666">2</span>         <span style="color:#666">2</span>         2m
nginx-3926361531   <span style="color:#666">2</span>         <span style="color:#666">2</span>         <span style="color:#666">0</span>         6s
nginx-3926361531   <span style="color:#666">2</span>         <span style="color:#666">2</span>         <span style="color:#666">1</span>         18s
nginx-2142116321   <span style="color:#666">1</span>         <span style="color:#666">2</span>         <span style="color:#666">2</span>         2m
nginx-2142116321   <span style="color:#666">1</span>         <span style="color:#666">2</span>         <span style="color:#666">2</span>         2m
nginx-3926361531   <span style="color:#666">3</span>         <span style="color:#666">2</span>         <span style="color:#666">1</span>         18s
nginx-3926361531   <span style="color:#666">3</span>         <span style="color:#666">2</span>         <span style="color:#666">1</span>         18s
nginx-2142116321   <span style="color:#666">1</span>         <span style="color:#666">1</span>         <span style="color:#666">1</span>         2m
nginx-3926361531   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">1</span>         18s
nginx-3926361531   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">2</span>         19s
nginx-2142116321   <span style="color:#666">0</span>         <span style="color:#666">1</span>         <span style="color:#666">1</span>         2m
nginx-2142116321   <span style="color:#666">0</span>         <span style="color:#666">1</span>         <span style="color:#666">1</span>         2m
nginx-2142116321   <span style="color:#666">0</span>         <span style="color:#666">0</span>         <span style="color:#666">0</span>         2m
nginx-3926361531   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">3</span>         20s
^C
$ kubectl get rs
NAME               DESIRED   CURRENT   READY     AGE
nginx-2142116321   <span style="color:#666">0</span>         <span style="color:#666">0</span>         <span style="color:#666">0</span>         2m
nginx-3926361531   <span style="color:#666">3</span>         <span style="color:#666">3</span>         <span style="color:#666">3</span>         28s</code></pre></div>
<blockquote class="note">
  <div><strong>注意：</strong> You cannot rollback a paused Deployment until you resume it.</div>
</blockquote>

<h2 id="deployment-status">Deployment status</h2>

<p>A Deployment enters various states during its lifecycle. It can be <a href="#progressing-deployment">progressing</a> while
rolling out a new ReplicaSet, it can be <a href="#complete-deployment">complete</a>, or it can <a href="#failed-deployment">fail to progress</a>.</p>

<h3 id="progressing-deployment">Progressing Deployment</h3>

<p>Kubernetes marks a Deployment as <em>progressing</em> when one of the following tasks is performed:</p>

<ul>
<li>The Deployment creates a new ReplicaSet.</li>
<li>The Deployment is scaling up its newest ReplicaSet.</li>
<li>The Deployment is scaling down its older ReplicaSet(s).</li>
<li>New Pods become ready or available (ready for at least <a href="#min-ready-seconds">MinReadySeconds</a>).</li>
</ul>

<p>You can monitor the progress for a Deployment by using <code>kubectl rollout status</code>.</p>

<h3 id="complete-deployment">Complete Deployment</h3>

<p>Kubernetes marks a Deployment as <em>complete</em> when it has the following characteristics:</p>

<ul>
<li>All of the replicas associated with the Deployment have been updated to the latest version you&rsquo;ve specified, meaning any
updates you&rsquo;ve requested have been completed.</li>
<li>All of the replicas associated with the Deployment are available.</li>
<li>No old replicas for the Deployment are running.</li>
</ul>

<p>You can check if a Deployment has completed by using <code>kubectl rollout status</code>. If the rollout completed
successfully, <code>kubectl rollout status</code> returns a zero exit code.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout status deploy/nginx-deployment
Waiting <span style="color:#a2f;font-weight:bold">for</span> rollout to finish: <span style="color:#666">2</span> of <span style="color:#666">3</span> updated replicas are available...
deployment <span style="color:#b44">&#34;nginx&#34;</span> successfully rolled out
$ <span style="color:#a2f">echo</span> <span style="color:#b8860b">$?</span>
<span style="color:#666">0</span></code></pre></div>
<h3 id="failed-deployment">Failed Deployment</h3>

<p>Your Deployment may get stuck trying to deploy its newest ReplicaSet without ever completing. This can occur
due to some of the following factors:</p>

<ul>
<li>Insufficient quota</li>
<li>Readiness probe failures</li>
<li>Image pull errors</li>
<li>Insufficient permissions</li>
<li>Limit ranges</li>
<li>Application runtime misconfiguration</li>
</ul>

<p>One way you can detect this condition is to specify a deadline parameter in your Deployment spec:
(<a href="#progress-deadline-seconds"><code>spec.progressDeadlineSeconds</code></a>). <code>spec.progressDeadlineSeconds</code> denotes the
number of seconds the Deployment controller waits before indicating (in the Deployment status) that the
Deployment progress has stalled.</p>

<p>The following <code>kubectl</code> command sets the spec with <code>progressDeadlineSeconds</code> to make the controller report
lack of progress for a Deployment after 10 minutes:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl patch deployment/nginx-deployment -p <span style="color:#b44">&#39;{&#34;spec&#34;:{&#34;progressDeadlineSeconds&#34;:600}}&#39;</span>
<span style="color:#b44">&#34;nginx-deployment&#34;</span> patched</code></pre></div>
<p>Once the deadline has been exceeded, the Deployment controller adds a DeploymentCondition with the following
attributes to the Deployment&rsquo;s <code>status.conditions</code>:</p>

<ul>
<li>Type=Progressing</li>
<li>Status=False</li>
<li>Reason=ProgressDeadlineExceeded</li>
</ul>

<p>See the <a href="https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#typical-status-properties" target="_blank">Kubernetes API conventions</a> for more information on status conditions.</p>

<blockquote class="note">
  <div><strong>注意：</strong> Kubernetes will take no action on a stalled Deployment other than to report a status condition with
<code>Reason=ProgressDeadlineExceeded</code>. Higher level orchestrators can take advantage of it and act accordingly, for
example, rollback the Deployment to its previous version.</div>
</blockquote>

<blockquote class="note">
  <div><strong>注意：</strong> If you pause a Deployment, Kubernetes does not check progress against your specified deadline. You can
safely pause a Deployment in the middle of a rollout and resume without triggering the condition for exceeding the
deadline.</div>
</blockquote>

<p>You may experience transient errors with your Deployments, either due to a low timeout that you have set or
due to any other kind of error that can be treated as transient. For example, let&rsquo;s suppose you have
insufficient quota. If you describe the Deployment you will notice the following section:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl describe deployment nginx-deployment
&lt;...&gt;
Conditions:
  Type            Status  Reason
  ----            ------  ------
  Available       True    MinimumReplicasAvailable
  Progressing     True    ReplicaSetUpdated
  ReplicaFailure  True    FailedCreate
&lt;...&gt;</code></pre></div>
<p>If you run <code>kubectl get deployment nginx-deployment -o yaml</code>, the Deployment status might look like this:</p>

<pre><code>status:
  availableReplicas: 2
  conditions:
  - lastTransitionTime: 2016-10-04T12:25:39Z
    lastUpdateTime: 2016-10-04T12:25:39Z
    message: Replica set &quot;nginx-deployment-4262182780&quot; is progressing.
    reason: ReplicaSetUpdated
    status: &quot;True&quot;
    type: Progressing
  - lastTransitionTime: 2016-10-04T12:25:42Z
    lastUpdateTime: 2016-10-04T12:25:42Z
    message: Deployment has minimum availability.
    reason: MinimumReplicasAvailable
    status: &quot;True&quot;
    type: Available
  - lastTransitionTime: 2016-10-04T12:25:39Z
    lastUpdateTime: 2016-10-04T12:25:39Z
    message: 'Error creating: pods &quot;nginx-deployment-4262182780-&quot; is forbidden: exceeded quota:
      object-counts, requested: pods=1, used: pods=3, limited: pods=2'
    reason: FailedCreate
    status: &quot;True&quot;
    type: ReplicaFailure
  observedGeneration: 3
  replicas: 2
  unavailableReplicas: 2
</code></pre>

<p>Eventually, once the Deployment progress deadline is exceeded, Kubernetes updates the status and the
reason for the Progressing condition:</p>

<pre><code>Conditions:
  Type            Status  Reason
  ----            ------  ------
  Available       True    MinimumReplicasAvailable
  Progressing     False   ProgressDeadlineExceeded
  ReplicaFailure  True    FailedCreate
</code></pre>

<p>You can address an issue of insufficient quota by scaling down your Deployment, by scaling down other
controllers you may be running, or by increasing quota in your namespace. If you satisfy the quota
conditions and the Deployment controller then completes the Deployment rollout, you&rsquo;ll see the
Deployment&rsquo;s status update with a successful condition (<code>Status=True</code> and <code>Reason=NewReplicaSetAvailable</code>).</p>

<pre><code>Conditions:
  Type          Status  Reason
  ----          ------  ------
  Available     True    MinimumReplicasAvailable
  Progressing   True    NewReplicaSetAvailable
</code></pre>

<p><code>Type=Available</code> with <code>Status=True</code> means that your Deployment has minimum availability. Minimum availability is dictated
by the parameters specified in the deployment strategy. <code>Type=Progressing</code> with <code>Status=True</code> means that your Deployment
is either in the middle of a rollout and it is progressing or that it has successfully completed its progress and the minimum
required new replicas are available (see the Reason of the condition for the particulars - in our case
<code>Reason=NewReplicaSetAvailable</code> means that the Deployment is complete).</p>

<p>You can check if a Deployment has failed to progress by using <code>kubectl rollout status</code>. <code>kubectl rollout status</code>
returns a non-zero exit code if the Deployment has exceeded the progression deadline.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl rollout status deploy/nginx-deployment
Waiting <span style="color:#a2f;font-weight:bold">for</span> rollout to finish: <span style="color:#666">2</span> out of <span style="color:#666">3</span> new replicas have been updated...
error: deployment <span style="color:#b44">&#34;nginx&#34;</span> exceeded its progress deadline
$ <span style="color:#a2f">echo</span> <span style="color:#b8860b">$?</span>
<span style="color:#666">1</span></code></pre></div>
<h3 id="operating-on-a-failed-deployment">Operating on a failed deployment</h3>

<p>All actions that apply to a complete Deployment also apply to a failed Deployment. You can scale it up/down, roll back
to a previous revision, or even pause it if you need to apply multiple tweaks in the Deployment pod template.</p>

<h2 id="clean-up-policy">Clean up Policy</h2>

<p>You can set <code>.spec.revisionHistoryLimit</code> field in a Deployment to specify how many old ReplicaSets for
this Deployment you want to retain. The rest will be garbage-collected in the background. By default,
all revision history will be kept. In a future version, it will default to switch to 2.</p>

<blockquote class="note">
  <div><strong>注意：</strong> Explicitly setting this field to 0, will result in cleaning up all the history of your Deployment
thus that Deployment will not be able to roll back.</div>
</blockquote>

<h2 id="use-cases">Use Cases</h2>

<h3 id="canary-deployment">Canary Deployment</h3>

<p>If you want to roll out releases to a subset of users or servers using the Deployment, you
can create multiple Deployments, one for each release, following the canary pattern described in
<a href="/docs/concepts/cluster-administration/manage-deployment/#canary-deployments">managing resources</a>.</p>

<h2 id="writing-a-deployment-spec">Writing a Deployment Spec</h2>

<p>As with all other Kubernetes configs, a Deployment needs <code>apiVersion</code>, <code>kind</code>, and <code>metadata</code> fields.
For general information about working with config files, see <a href="/docs/tutorials/stateless-application/run-stateless-application-deployment/">deploying applications</a>,
configuring containers, and <a href="/docs/tutorials/object-management-kubectl/object-management/">using kubectl to manage resources</a> documents.</p>

<p>A Deployment also needs a <a href="https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#spec-and-status" target="_blank"><code>.spec</code> section</a>.</p>

<h3 id="pod-template">Pod Template</h3>

<p>The <code>.spec.template</code> is the only required field of the <code>.spec</code>.</p>

<p>The <code>.spec.template</code> is a <a href="/docs/concepts/workloads/pods/pod-overview/#pod-templates">pod template</a>. It has exactly the same schema as a <a href="/docs/concepts/workloads/pods/pod/">Pod</a>, except it is nested and does not have an
<code>apiVersion</code> or <code>kind</code>.</p>

<p>In addition to required fields for a Pod, a pod template in a Deployment must specify appropriate
labels and an appropriate restart policy. For labels, make sure not to overlap with other controllers. See <a href="#selector">selector</a>).</p>

<p>Only a <a href="/docs/concepts/workloads/pods/pod-lifecycle/#restart-policy"><code>.spec.template.spec.restartPolicy</code></a> equal to <code>Always</code> is
allowed, which is the default if not specified.</p>

<h3 id="replicas">Replicas</h3>

<p><code>.spec.replicas</code> is an optional field that specifies the number of desired Pods. It defaults to 1.</p>

<h3 id="selector">Selector</h3>

<p><code>.spec.selector</code> is an optional field that specifies a <a href="/docs/concepts/overview/working-with-objects/labels/">label selector</a>
for the Pods targeted by this deployment.</p>

<p>If specified, <code>.spec.selector</code> must match <code>.spec.template.metadata.labels</code>, or it will be rejected by
the API.  If <code>.spec.selector</code> is unspecified, <code>.spec.selector.matchLabels</code> defaults to
<code>.spec.template.metadata.labels</code>.</p>

<p>A Deployment may terminate Pods whose labels match the selector if their template is different
from <code>.spec.template</code> or if the total number of such Pods exceeds <code>.spec.replicas</code>. It brings up new
Pods with <code>.spec.template</code> if the number of Pods is less than the desired number.</p>

<blockquote class="note">
  <div><strong>注意：</strong> You should not create other pods whose labels match this selector, either directly, by creating
another Deployment, or by creating another controller such as a ReplicaSet or a ReplicationController. If you
do so, the first Deployment thinks that it created these other pods. Kubernetes does not stop you from doing this.</div>
</blockquote>

<p>If you have multiple controllers that have overlapping selectors, the controllers will fight with each
other and won&rsquo;t behave correctly.</p>

<h3 id="strategy">Strategy</h3>

<p><code>.spec.strategy</code> specifies the strategy used to replace old Pods by new ones.
<code>.spec.strategy.type</code> can be &ldquo;Recreate&rdquo; or &ldquo;RollingUpdate&rdquo;. &ldquo;RollingUpdate&rdquo; is
the default value.</p>

<h4 id="recreate-deployment">Recreate Deployment</h4>

<p>All existing Pods are killed before new ones are created when <code>.spec.strategy.type==Recreate</code>.</p>

<h4 id="rolling-update-deployment">Rolling Update Deployment</h4>

<p>The Deployment updates Pods in a <a href="/docs/tasks/run-application/rolling-update-replication-controller/">rolling update</a>
fashion when <code>.spec.strategy.type==RollingUpdate</code>. You can specify <code>maxUnavailable</code> and <code>maxSurge</code> to control
the rolling update process.</p>

<h5 id="max-unavailable">Max Unavailable</h5>

<p><code>.spec.strategy.rollingUpdate.maxUnavailable</code> is an optional field that specifies the maximum number
of Pods that can be unavailable during the update process. The value can be an absolute number (for example, 5)
or a percentage of desired Pods (for example, 10%). The absolute number is calculated from percentage by
rounding down. The value cannot be 0 if <code>.spec.strategy.rollingUpdate.maxSurge</code> is 0. The default value is 25%.</p>

<p>For example, when this value is set to 30%, the old ReplicaSet can be scaled down to 70% of desired
Pods immediately when the rolling update starts. Once new Pods are ready, old ReplicaSet can be scaled
down further, followed by scaling up the new ReplicaSet, ensuring that the total number of Pods available
at all times during the update is at least 70% of the desired Pods.</p>

<h5 id="max-surge">Max Surge</h5>

<p><code>.spec.strategy.rollingUpdate.maxSurge</code> is an optional field that specifies the maximum number of Pods
that can be created over the desired number of Pods. The value can be an absolute number (for example, 5) or a
percentage of desired Pods (for example, 10%). The value cannot be 0 if <code>MaxUnavailable</code> is 0. The absolute number
is calculated from the percentage by rounding up. The default value is 25%.</p>

<p>For example, when this value is set to 30%, the new ReplicaSet can be scaled up immediately when the
rolling update starts, such that the total number of old and new Pods does not exceed 130% of desired
Pods. Once old Pods have been killed, the new ReplicaSet can be scaled up further, ensuring that the
total number of Pods running at any time during the update is at most 130% of desired Pods.</p>

<h3 id="progress-deadline-seconds">Progress Deadline Seconds</h3>

<p><code>.spec.progressDeadlineSeconds</code> is an optional field that specifies the number of seconds you want
to wait for your Deployment to progress before the system reports back that the Deployment has
<a href="#failed-deployment">failed progressing</a> - surfaced as a condition with <code>Type=Progressing</code>, <code>Status=False</code>.
and <code>Reason=ProgressDeadlineExceeded</code> in the status of the resource. The deployment controller will keep
retrying the Deployment. In the future, once automatic rollback will be implemented, the deployment
controller will roll back a Deployment as soon as it observes such a condition.</p>

<p>If specified, this field needs to be greater than <code>.spec.minReadySeconds</code>.</p>

<h3 id="min-ready-seconds">Min Ready Seconds</h3>

<p><code>.spec.minReadySeconds</code> is an optional field that specifies the minimum number of seconds for which a newly
created Pod should be ready without any of its containers crashing, for it to be considered available.
This defaults to 0 (the Pod will be considered available as soon as it is ready). To learn more about when
a Pod is considered ready, see <a href="/docs/concepts/workloads/pods/pod-lifecycle/#container-probes">Container Probes</a>.</p>

<h3 id="rollback-to">Rollback To</h3>

<p><code>.spec.rollbackTo</code> is an optional field with the configuration the Deployment
should roll back to. Setting this field triggers a rollback, and this field will
be cleared by the server after a rollback is done.</p>

<p>Because this field will be cleared by the server, it should not be used
declaratively. For example, you should not perform <code>kubectl apply</code> with a
manifest with <code>.spec.rollbackTo</code> field set.</p>

<h4 id="revision">Revision</h4>

<p><code>.spec.rollbackTo.revision</code> is an optional field specifying the revision to roll
back to. Setting to 0 means rolling back to the last revision in history;
otherwise, means rolling back to the specified revision. This defaults to 0 when
<a href="#rollback-to"><code>spec.rollbackTo</code></a> is set.</p>

<h3 id="revision-history-limit">Revision History Limit</h3>

<p>A Deployment&rsquo;s revision history is stored in the replica sets it controls.</p>

<p><code>.spec.revisionHistoryLimit</code> is an optional field that specifies the number of old ReplicaSets to retain
to allow rollback. Its ideal value depends on the frequency and stability of new Deployments. All old
ReplicaSets will be kept by default, consuming resources in <code>etcd</code> and crowding the output of <code>kubectl get rs</code>,
if this field is not set. The configuration of each Deployment revision is stored in its ReplicaSets;
therefore, once an old ReplicaSet is deleted, you lose the ability to rollback to that revision of Deployment.</p>

<p>More specifically, setting this field to zero means that all old ReplicaSets with 0 replica will be cleaned up.
In this case, a new Deployment rollout cannot be undone, since its revision history is cleaned up.</p>

<h3 id="paused">Paused</h3>

<p><code>.spec.paused</code> is an optional boolean field for pausing and resuming a Deployment. The only difference between
a paused Deployment and one that is not paused, is that any changes into the PodTemplateSpec of the paused
Deployment will not trigger new rollouts as long as it is paused. A Deployment is not paused by default when
it is created.</p>

<h2 id="alternative-to-deployments">Alternative to Deployments</h2>

<h3 id="kubectl-rolling-update">kubectl rolling update</h3>

<p><a href="/docs/user-guide/kubectl/v1.16/#rolling-update">Kubectl rolling update</a> updates Pods and ReplicationControllers
in a similar fashion. But Deployments are recommended, since they are declarative, server side, and have
additional features, such as rolling back to any previous revision even after the rolling update is done.</p>















    
            
  <h2>反馈</h2>
  <p class="feedback--prompt">此页是否对您有帮助？ </p>
  <button class="button feedback--yes">是</button>
  <button class="button feedback--no">否</button>
  <p class="feedback--response feedback--response__hidden">
    感谢反馈。如果您有一个关于如何使用 Kubernetes 的特定的、需要答案的问题，可以访问
    <a target="_blank" rel="noopener"
      href="https://stackoverflow.com/questions/tagged/kubernetes">
      Stack Overflow</a>.
    在 GitHub 仓库上登记新的问题
    <a class="feedback--link" target="_blank" rel="noopener"
      href="https://github.com/kubernetes/website/issues/new?title=Issue%20with%20k8s.io">
      报告问题</a>
    或者
    <a class="feedback--link" target="_blank" rel="noopener"
      href="https://github.com/kubernetes/website/issues/new?title=Improvement%20for%20k8s.io">
      提出改进建议</a>.
  </p>
  <script>
    const yes = document.querySelector('.feedback--yes');
    const no = document.querySelector('.feedback--no');
    document.querySelectorAll('.feedback--link').forEach(link => {
      link.href = link.href + window.location.pathname;
    });
    const sendFeedback = (value) => {
      if (!gtag) { console.log('!gtag'); }
      gtag('event', 'click', {
        'event_category': 'Helpful',
        'event_label': window.location.pathname,
        value
      });
    };
    const disableButtons = () => {
      yes.disabled = true;
      yes.classList.add('feedback--button__disabled');
      no.disabled = true;
      no.classList.add('feedback--button__disabled');
    };
    yes.addEventListener('click', () => {
      sendFeedback(1);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
    no.addEventListener('click', () => {
      sendFeedback(0);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
  </script>


    
            <div id="pre-footer"> 
  <hr />

  <div class="issue-button-container">
    <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/concepts/workloads/controllers/deployment.md?pixel" alt="Analytics" /></a></p>
    
    
    <script type="text/javascript">
    PDRTJS_settings_8345992 = {
    "id" : "8345992",
    "unique_id" : "\/zh\/docs\/concepts\/workloads\/controllers\/deployment\/",
    "title" : "Deployments",
    "permalink" : "https:\/\/kubernetes.io\/zh\/docs\/concepts\/workloads\/controllers\/deployment\/"
    };
    (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
    </script>
    <a href="" onclick="window.open('https://github.com/kubernetes/website/issues/new?template=bug-report.md&title=Issue%20with%20' +
    'k8s.io'+window.location.pathname)" class="button issue">报告 GitHub 问题</a>
    
    
    
    <a href="https://github.com/kubernetes/website/edit/master/content/zh/docs/concepts/workloads/controllers/deployment.md" class="button issue">修改本页面</a>
    
  </div>
  

  <div id="lastedit" class="lastedit issue-button-container">
    页面最后一次修改于 December 25, 2019 at 8:53 AM PST 由：
    <a href="https://github.com/kubernetes/website/commit/0f2bd2871bbb2be9c635054e690b92524670f1e7/">zh-trans: merge zh content from release-1.16-temporary into release-1.16 (#18216)</a> (<a href="https://github.com/kubernetes/website/commits/master/content/en/docs/concepts/workloads/controllers/deployment.md">页面历史</a>)
  </div>
  
</div>

          </div>
        </section>
    </main>
		<footer>
    <div class="light-text main-section">
        <nav>
            
            
            
            <a href="/zh/docs/home/">主页</a>
            
            <a href="/zh/blog/">博客</a>
            
            <a href="/zh/partners/">合作伙伴</a>
            
            <a href="/zh/community/">社区</a>
            
            <a href="/zh/case-studies/">案例分析</a>
            
        </nav>
        <div class="social" role="region" aria-label="Social hyperlinks">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                <a href="https://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://www.youtube.com/kubernetescommunity" class="youtube"><span>YouTube</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>论坛</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>事件日历</span></a>
            </div>
            <div>
                
                <a href="https://git.k8s.io/community/contributors/guide" class="button">贡献</a>
            </div>
        </div>
        <div class="miceType center">
            &copy; 2023 The Kubernetes 作者 | 文档发布基于 <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a> 授权许可</a>
        </div>
        <div class="miceType center">
            Copyright &copy; 2023 Linux 基金会&reg;。保留所有权利。Linux 基金会已注册并使用商标。如需了解 Linux 基金会的商标列表，请访问<a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">商标使用页面</a>
        </div>
        <div class="miceType center">
            ICP license: 京ICP备17074266号-3
        </div>
    </div>
</footer>

		<button class="flyout-button" onclick="kub.toggleToc()" aria-label="Toggle table of contents visibility"></button>

<script>

(function () {
    window.addEventListener('DOMContentLoaded', init)

        
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>



    <script language="application/javascript">
      
      (function addHeadingLinks(){
        var article = document.getElementById('docsContent');
        var headings = article.querySelectorAll('h1, h2, h3, h4, h5, h6');
        headings.forEach(function(heading){
          if(heading.id){
            var a = document.createElement('a');
            a.innerHTML = heading.innerHTML;
            a.href = '#'+heading.id;
            a.classList.add('inpage_heading');
            heading.innerHTML = '';
            heading.appendChild(a);
          }
        });
      })();
    </script>
	</body>
</html>
